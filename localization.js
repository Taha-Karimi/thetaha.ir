const translations = {
  en: {
    about: {
      headline: "Frontend Engineer | Architecting Fast and Reliable UIs",
      body: "I specialize in developing interfaces that are scalable and reliable in execution, prioritizing runtime behavior over static aesthetics. With 2+ years of freelance experience, I've worked on high-stakes, complex products, including crypto exchange platforms and high-performance Telegram Mini Apps. My focus is on robust code architecture that guarantees performance and minimizes technical debt.",
    },
    experience: {
      title: "Frontend Developer | Specialized Freelancer",
      period: "2023 – Present",
      items: [
        "Innovation in the Telegram Ecosystem: Developed and optimized multiple Telegram Mini Apps (TMAs), focusing intensely on low-latency response times and delivering a near-native user experience.",
        "Sensitive Financial Projects: Engineered the frontend for a crypto exchange platform, managing complex state and displaying real-time data streams with minimal delay.",
        "Strategic Next.js Implementation: Deployed advanced rendering methods (SSR/SSG) using the Next.js App Router to ensure high SEO scores and excellent Core Web Vitals performance.",
        "Robust API Integration: Designed an error-resilient API interaction layer and efficiently managed complex data flow in large-scale applications.",
        "Cross-Device Consistency: Built fully responsive, Mobile-First interfaces that maintain a consistent and optimized experience across all screen sizes.",
      ],
    },
    skills: {
      frontend: [
        "React.js (Mastery of hooks and scalable patterns)",
        "Next.js (App Router, Caching, Data Fetching)",
        "JavaScript (ES6+)",
        "TypeScript (Familiarity)",
      ],
      uiUx: [
        "Tailwind CSS (Utility-first UI development)",
        "Responsive Design",
        "Implementing Design Systems",
      ],
      performance: [
        "Monitoring and improving Core Web Vitals",
        "Component rendering optimization techniques (Memoization)",
        "Bundle size reduction",
      ],
      tools: [
        "Git/GitHub",
        "RESTful APIs",
        "Clean Code principles and maintainable practices",
        "In-depth debugging and troubleshooting",
      ],
    },
    education: "B.Sc. Student in Computer Engineering",
    workPhilosophy: [
      "Sustainable Code: Clean code is a long-term asset; rushed code is technical debt.",
      "Usability First: A UI must be functional and usable in daily operation before it is beautiful in a demo.",
      "Production Mindset: A product's true value is proven in the Production environment under real-world load.",
    ],
    nav: {
      about: "About",
      experience: "Experience",
      projects: "Projects",
      contact: "Contact",
    },
    hero: {
      badge: "Open to work",
      title:
        "Architecting <br /> <span class='gradient-text'>Scalable Web Systems</span>",
      subtitle:
        "Frontend Developer specializing in building complex products. Focusing on clean architecture and high performance for production-level projects.",
      cta_talk: "Let's Talk",
      cta_work: "View Work",
    },
  },
  fa: {
    about: {
      headline: "مهندس فرانت‌اند | خالق رابط‌های کاربری سریع و پایدار",
      body: "من رابط‌های کاربری را برای محصولات پیچیده‌ای می‌سازم که نیاز به دقت مهندسی بالایی دارند. در طول بیش از دو سال فعالیت به صورت فریلنس، در پروژه‌های عملیاتی متعددی از جمله پلتفرم‌های تبادل ارز دیجیتال و اکوسیستم‌های مبتنی بر تلگرام مشارکت داشته‌ام. با وجود اینکه بخش عمده‌ای از کارهای اخیر من تحت قرارداد محرمانگی (NDA) هستند، تمرکز من همیشه بر یک اصل ثابت است: تحویل کدی تمیز و معماری قابل‌اطمینانی که فراتر از ظاهر، در دنیای واقعی و ترافیک بالا به درستی عمل کند.",
    },
    experience: {
      title: "توسعه‌دهنده فرانت‌اند | فریلنس (پروژه‌محور)",
      period: "۲۰۲۳ – اکنون",
      items: [
        "React & Next.js: توسعه اپلیکیشن‌های بهینه‌شده برای موتورهای جستجو (SEO) و رندرینگ سمت سرور با مدیریت دقیق وضعیت (State).",
        "TypeScript: پیاده‌سازی تایپینگ سخت‌گیرانه برای تضمین پایداری کد و تسهیل توسعه تیمی در پروژه‌های بزرگ.",
        "Telegram Mini Apps (TMA): خلق تجربه‌های وب روان و کاربردی مستقیماً در بستر تلگرام.",
        "فین‌تک و کریپتو: تجربه کار با داده‌های آنی (Real-time) و مدیریت جریان‌های کاربری حساس در پلتفرم‌های معاملاتی.",
      ],
    },
    skills: {
      frontend: ["React.js", "Next.js", "JavaScript (ES6+)", "TypeScript"],
      uiUx: ["Tailwind CSS", "Responsive Design", "Design Systems"],
      performance: ["Core Web Vitals", "Memoization", "Bundle Optimization"],
      tools: ["Git/GitHub", "RESTful APIs", "Clean Code", "Debugging"],
    },
    education: "دانشجوی مهندسی کامپیوتر",
    workPhilosophy: [
      "معماری تمیز (Clean Architecture): نوشتن کدهای ماژولار و خوانا که با رشد و گسترش پروژه، قابلیت نگهداری خود را حفظ کنند.",
      "بهینه‌سازی عملکرد: تحلیل و اصلاح زیرساخت‌های فرانت‌اند برای دستیابی به کمترین زمان بارگذاری و بیشترین سرعت پاسخگویی.",
      "کلام آخر: آماده همکاری در پروژه‌هایی هستم که به انضباط در مهندسی فرانت‌اند و خروجی‌های آماده‌ی بهره‌برداری (Production-ready) اهمیت می‌دهند.",
    ],
    nav: {
      about: "درباره من",
      experience: "تجربیات",
      projects: "پروژه‌ها",
      contact: "تماس",
    },
    hero: {
      badge: "آماده همکاری",
      title:
        "<span class='font-persian'>معماری سیستم‌های <br /> <span class='gradient-text'>وب مقیاس‌پذیر</span></span>",
      subtitle:
        "توسعه‌دهنده فرانت‌اند؛ تبدیل نیازمندی‌های پیچیده به سیستم‌های تحت وب کارآمد. متخصص Next.js و React با تجربه در پروژه‌های حساس و با ترافیک بالا.",
      cta_talk: "گفتگو کنیم",
      cta_work: "مشاهده کارها",
    },
  },
};

// Animation utilities
const animationUtils = {
  fadeIn: (element, delay = 0) => {
    setTimeout(() => {
      element.style.opacity = "0";
      element.style.transform = "translateY(20px)";
      element.style.transition = "opacity 0.6s ease, transform 0.6s ease";

      requestAnimationFrame(() => {
        requestAnimationFrame(() => {
          element.style.opacity = "1";
          element.style.transform = "translateY(0)";
        });
      });
    }, delay);
  },

  staggerFadeIn: (elements, baseDelay = 0, increment = 100) => {
    elements.forEach((el, index) => {
      animationUtils.fadeIn(el, baseDelay + index * increment);
    });
  },
};

function renderContent(lang) {
  const t = translations[lang];
  const isRTL = lang === "fa";

  // Set Direction and Font with smooth transition
  document.documentElement.style.transition = "all 0.3s ease";
  document.documentElement.dir = isRTL ? "rtl" : "ltr";
  document.documentElement.lang = lang;

  if (isRTL) {
    document.body.classList.add("font-persian");
    document.body.classList.remove("font-sans");
  } else {
    document.body.classList.add("font-sans");
    document.body.classList.remove("font-persian");
  }

  // Helper to safely set text with animation
  const setText = (id, text, animate = true) => {
    const el = document.getElementById(id);
    if (el) {
      if (animate) {
        el.style.opacity = "0";
        setTimeout(() => {
          el.textContent = text;
          el.style.transition = "opacity 0.3s ease";
          el.style.opacity = "1";
        }, 150);
      } else {
        el.textContent = text;
      }
    }
  };

  const setHTML = (id, html, animate = true) => {
    const el = document.getElementById(id);
    if (el) {
      if (animate) {
        el.style.opacity = "0";
        setTimeout(() => {
          el.innerHTML = html;
          el.style.transition = "opacity 0.3s ease";
          el.style.opacity = "1";
        }, 150);
      } else {
        el.innerHTML = html;
      }
    }
  };

  // Nav
  setText("nav-about", t.nav.about);
  setText("nav-experience", t.nav.experience);
  setText("nav-projects", t.nav.projects);
  setText("nav-contact", t.nav.contact);

  // Mobile Nav
  setText("mobile-nav-about", t.nav.about);
  setText("mobile-nav-experience", t.nav.experience);
  setText("mobile-nav-projects", t.nav.projects);
  setText("mobile-nav-contact", t.nav.contact);

  // Hero with stagger animation
  setText("hero-badge", t.hero.badge);
  setHTML("hero-title", t.hero.title);
  setHTML("hero-subtitle", t.hero.subtitle);
  setHTML(
    "hero-cta-talk",
    `${t.hero.cta_talk} <i class="fas fa-arrow-${
      isRTL ? "left" : "right"
    } transform ${isRTL ? "" : "-rotate-45"} group-hover:${
      isRTL ? "" : "rotate-0"
    } transition-transform"></i>`
  );
  setText("hero-cta-work", t.hero.cta_work);

  // About
  setText("about-headline", t.about.headline);
  setText("about-body", t.about.body);

  // Education
  const eduEl = document.getElementById("education-text");
  if (eduEl) setText("education-text", t.education);

  // Work Philosophy with enhanced styling
  const philosophyContainer = document.getElementById("philosophy-list");
  if (philosophyContainer) {
    philosophyContainer.innerHTML = t.workPhilosophy
      .map((item) => {
        const [title, desc] = item.split(":");
        return `
          <li class="mb-3 flex items-start gap-3 group">
            <span class="mt-1 w-2 h-2 rounded-full bg-indigo-500 flex-shrink-0 group-hover:scale-150 transition-transform"></span>
            <span>
              <strong class="text-white font-semibold">${title}:</strong> 
              <span class="text-gray-400">${desc || ""}</span>
            </span>
          </li>`;
      })
      .join("");
  }

  // Experience with enhanced animations
  const expContainer = document.getElementById("experience-list");
  if (expContainer) {
    expContainer.innerHTML = `
      <div class="relative group">
        <span class="absolute ${
          isRTL
            ? "-right-[41px] md:-right-[57px]"
            : "-left-[41px] md:-left-[57px]"
        } top-2 w-5 h-5 rounded-full border-4 border-background bg-indigo-500 group-hover:scale-125 transition-transform duration-300 shadow-[0_0_20px_rgba(99,102,241,0.6)] animate-pulse"></span>
        <div class="glass-card shimmer p-8 rounded-2xl border border-white/5 group-hover:border-indigo-500/30 transition-all">
          <div class="flex flex-col md:flex-row md:items-center justify-between mb-4 gap-2">
            <div>
              <h3 class="text-xl font-bold text-white mb-1 flex items-center gap-2">
                <i class="fas fa-briefcase text-indigo-400"></i>
                ${t.experience.title}
              </h3>
              <div class="text-indigo-400 font-medium flex items-center gap-2">
                <i class="fas fa-calendar-alt text-sm"></i>
                ${t.experience.period}
              </div>
            </div>
          </div>
          <ul class="text-gray-400 mb-6 leading-relaxed list-none space-y-3 ${
            isRTL ? "pr-0" : "pl-0"
          }">
            ${t.experience.items
              .map((item) => {
                if (item.includes(":")) {
                  const parts = item.split(":");
                  return `
                    <li class="flex items-start gap-3 group/item">
                      <span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-purple-500 flex-shrink-0 group-hover/item:scale-150 transition-transform"></span>
                      <span>
                        <strong class="text-gray-200">${parts[0]}:</strong>
                        <span class="text-gray-400">${parts
                          .slice(1)
                          .join(":")}</span>
                      </span>
                    </li>`;
                }
                return `
                  <li class="flex items-start gap-3 group/item">
                    <span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-purple-500 flex-shrink-0 group-hover/item:scale-150 transition-transform"></span>
                    <span>${item}</span>
                  </li>`;
              })
              .join("")}
          </ul>
        </div>
      </div>
    `;
  }

  // Skills with enhanced visual hierarchy
  const skillsContainer = document.getElementById("skills-container");
  if (skillsContainer) {
    const categories = [
      {
        key: "frontend",
        icon: "fa-code",
        color: "cyan",
        bgColor: "bg-cyan-500/10",
        borderColor: "border-cyan-500/20",
        textColor: "text-cyan-400",
        title: lang === "en" ? "Frontend" : "فرانت‌اند",
      },
      {
        key: "uiUx",
        icon: "fa-paint-brush",
        color: "pink",
        bgColor: "bg-pink-500/10",
        borderColor: "border-pink-500/20",
        textColor: "text-pink-400",
        title: lang === "en" ? "UI/UX" : "رابط کاربری",
      },
      {
        key: "performance",
        icon: "fa-tachometer-alt",
        color: "green",
        bgColor: "bg-green-500/10",
        borderColor: "border-green-500/20",
        textColor: "text-green-400",
        title: lang === "en" ? "Performance" : "بهینه‌سازی",
      },
      {
        key: "tools",
        icon: "fa-tools",
        color: "yellow",
        bgColor: "bg-yellow-500/10",
        borderColor: "border-yellow-500/20",
        textColor: "text-yellow-400",
        title: lang === "en" ? "Tools" : "ابزارها",
      },
    ];

    skillsContainer.innerHTML = `
      <h3 class="text-xl font-bold text-white mb-6 flex items-center gap-2">
        <i class="fas fa-layer-group text-indigo-400"></i>
        ${lang === "en" ? "Tech Stack" : "مهارت‌ها"}
      </h3>
      <div class="space-y-6">
        ${categories
          .map(
            (cat) => `
            <div class="group/category">
              <h4 class="text-sm font-bold ${
                cat.textColor
              } mb-3 flex items-center gap-2 uppercase tracking-wider">
                <span class="w-8 h-8 rounded-lg ${
                  cat.bgColor
                } flex items-center justify-center group-hover/category:scale-110 transition-transform">
                  <i class="fas ${cat.icon}"></i>
                </span>
                ${cat.title}
              </h4>
              <div class="flex flex-wrap gap-2 ${isRTL ? "mr-10" : "ml-10"}">
                ${t.skills[cat.key]
                  .map(
                    (skill) => `
                  <span class="px-3 py-1.5 ${cat.bgColor} ${cat.textColor} rounded-lg text-xs border ${cat.borderColor} hover:border-${cat.color}-500/50 hover:scale-105 transition-all cursor-default backdrop-blur-sm">
                    ${skill}
                  </span>
                `
                  )
                  .join("")}
              </div>
            </div>
          `
          )
          .join("")}
      </div>
    `;
  }

  // Trigger animations for newly rendered content
  setTimeout(() => {
    const cards = document.querySelectorAll(".glass-card");
    animationUtils.staggerFadeIn(Array.from(cards), 0, 100);
  }, 200);
}

// Initialize with enhanced loading animation
document.addEventListener("DOMContentLoaded", () => {
  // Show loading state
  document.body.style.opacity = "0";

  // Render default language
  renderContent("en");

  // Fade in the page
  setTimeout(() => {
    document.body.style.transition = "opacity 0.6s ease";
    document.body.style.opacity = "1";
  }, 100);

  const btn = document.getElementById("lang-toggle");
  if (btn) {
    // Enhanced button interaction
    btn.style.transition = "all 0.3s ease";

    btn.addEventListener("click", () => {
      const currentLang = document.documentElement.lang || "en";
      const newLang = currentLang === "en" ? "fa" : "en";

      // Button animation
      btn.style.transform = "scale(0.9)";
      setTimeout(() => {
        btn.style.transform = "scale(1)";
      }, 150);

      // Update content
      renderContent(newLang);
      btn.textContent = newLang === "en" ? "FA" : "EN";

      // Store preference
      try {
        localStorage.setItem("preferredLanguage", newLang);
      } catch (e) {
        // localStorage not available, skip
      }
    });

    // Check for saved language preference
    try {
      const savedLang = localStorage.getItem("preferredLanguage");
      if (savedLang && savedLang !== "en") {
        renderContent(savedLang);
        btn.textContent = savedLang === "en" ? "FA" : "EN";
      }
    } catch (e) {
      // localStorage not available, skip
    }
  }

  // Add keyboard shortcut for language toggle (Alt + L)
  document.addEventListener("keydown", (e) => {
    if (e.altKey && e.key === "l") {
      e.preventDefault();
      btn?.click();
    }
  });
});
